<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="play_motion_config"  default="approach_planner"/>
  <arg name="rviz"  default="true"/>

  <!-- marker detector -->
  <node pkg="aruco_ros" type="marker_publisher"  name="aruco_marker_publisher">
    <remap from="/camera_info"       to="/movo_camera/sd/camera_info" />
    <remap from="/image"             to="/movo_camera/sd/image_color" />
    <param name="image_is_rectified" value="True"/>
    <param name="marker_size"        value="0.1778"/>
    <param name="reference_frame"    value="base_link"/>
    <param name="camera_frame"       value="movo_camera_ir_optical_frame"/>
    <param name="marker_frame"       value="aruco_frame" />
    <param name="corner_refinement"  value="SUBPIX" />
  </node>

  <!-- Load definition of pregrasp motion into play_motion namespace -->
  <rosparam command="load" file="$(find movo_pick_and_place)/config/pick_motions.yaml" /> 

  <!-- Pick & place server -->
  <node name="pick_and_place_server" pkg="movo_pick_and_place" type="pick_and_place_server.py" output="screen">
    <rosparam command="load" file="$(find movo_pick_and_place)/config/pick_and_place_params.yaml" />
    <param name="object_width"  value="0.05" />
    <param name="object_height" value="0.1" />
    <param name="object_depth"  value="0.05" />
  </node>

  <!-- Node exposing service to start looking for the object and trigger the picking -->
  <node name="pick_client" pkg="movo_pick_and_place" type="pick_client.py" output="screen"/>

  <node pkg="play_motion" type="play_motion" name="play_motion">
    <rosparam file="$(find movo_pick_and_place)/config/$(arg play_motion_config).yaml" command="load" />
  </node>

</launch>
